<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sign up í˜ì´ì§€ (feat. MySQL, NodeJS)</title>
    <!-- ëˆˆê¹Œë¦¬ì½”ë“œ -->
    <style>   
        .password-container {
            position: relative;
            display: inline-block;
        }
        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
        }
    
        #idCheckResult {
            font-weight: bold;
        }
        #idCheckResult.duplicate {
            color: red;
        }

        #idCheckResult.not_duplicate {
            color: blue;
         }
    </style>
</head>
<body>
    <h1>ì‚¬ìš©ì ë“±ë¡ í˜ì´ì§€</h1>
    <br>
    <form method="post" action="/process/adduser" name="join">
        <table>
            <tr>
                <td><label>ì‚¬ìš©ìëª…</label></td>
                <td><input type="text" name="name"></td>
            </tr>
            <tr>
                <td><label>ë‹‰ë„¤ì„</label></td>
                <td><input type="text" name="nickname"></td>
            </tr>
            <tr>
                <td><label>ì•„ì´ë””</label></td>
                <td><input type="text" name="id" id="userId"></td>
                <td><button type="button" onclick="checkDuplicate()">ì¤‘ë³µ í™•ì¸</button></td>
                <td><span id="idCheckResult"></span></td>
            </tr>
        </table>
        <form name="join">
            <div class="password-container">
                íŒ¨ìŠ¤ì›Œë“œ: <input type="password" id="password1" name="password">
                <span class="toggle-password" onclick="togglePassword('password1')">ğŸ‘ï¸</span>
            </div>
            <div class="password-container">
                íŒ¨ìŠ¤ì›Œë“œ í™•ì¸: <input type="password" id="password2">
        
            </div>
        </form>
        <input type="button" onclick="test()" value="íšŒì›ê°€ì…">
    </form>
    <script>  // ëˆˆê¹Œë¦¬ì½”ë“œ
        function togglePassword(fieldId) {
            var passwordField = document.getElementById(fieldId);
            var passwordFieldType = passwordField.getAttribute('type');
            if (passwordFieldType === 'password') {
                passwordField.setAttribute('type', 'text');
            } else {
                passwordField.setAttribute('type', 'password');
            }
        }

        function test() {
            var p1 = document.getElementById('password1').value;
            var p2 = document.getElementById('password2').value;
        
            if (p1 !== p2) {
                alert("íŒ¨ìŠ¤ì›Œë“œ ë¶ˆì¼ì¹˜");
                return false;
            } else {
                alert("íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ì¹˜í•©ë‹ˆë‹¤");
                document.forms['join'].submit(); // í¼ ì œì¶œ
            }
        }
        
        function checkDuplicate() {
            var userId = document.getElementById('userId').value;
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/process/checkduplicate', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState == XMLHttpRequest.DONE && xhr.status == 200) {
                    var response = xhr.responseText;
                    var idCheckResult = document.getElementById('idCheckResult');
                    idCheckResult.innerText = response === 'duplicate' ? 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤.' : 'ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤.';
                    idCheckResult.className = response;
                }
            };
            xhr.send('id=' + encodeURIComponent(userId));
        }
    </script>
</body>
</html>

